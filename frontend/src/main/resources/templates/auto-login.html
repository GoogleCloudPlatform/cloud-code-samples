<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="google-signin-client_id"
    content="974574715204-4ttrkcsmd7i4ltgmon64klu2a0uocjiu.apps.googleusercontent.com">
  <title>Guestbook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" th:href="@{/css/bootstrap.css}" type="text/css">
  <link rel="stylesheet" th:href="@{/css/style.css}" type="text/css">
  <link rel="icon" th:href="@{/favicon.png}" type="image/x-icon" />
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <script>
    function onSignIn(googleUser) {
      var profile = googleUser.getBasicProfile();
      var xhr = new XMLHttpRequest();
      xhr.open('POST', `${location.origin}/tokensignin`);
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.onload = function () {
        console.log('Signed in as: ' + xhr.responseText);
      };
      xhr.send(JSON.stringify({
        "username": profile.getName(),
        "email": profile.getEmail(),
        "password": googleUser.getAuthResponse().id_token
      }));
    }
  </script>
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
</head>

<body>
  <form th:action="@{/login}" method="post" th:object="${formmessage}" id="login-form">
    <label class="sr-only" for="username">Username</label>
    <div class="mb-2">
      <div>Username</div>
      <input type="text" class="form-control" id="login-username" name="username" required>
    </div>
    <label class="sr-only" for="username">Password</label>
    <div class="mb-2">
      <div>Password</div>
      <input type="password" class="form-control" id="login-password" name="password" required>
    </div>
    <button type="submit" class="btn btn-primary mb-2 fw-btn mt-1">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" class="icn">
        <path
          d="M26.5 6h-13c-.827 0-1.5.673-1.5 1.5V12a1 1 0 1 0 2 0V8h12v16H14v-4a1 1 0 1 0-2 0v4.5c0 .827.673 1.5 1.5 1.5h13c.827 0 1.5-.673 1.5-1.5v-17c0-.827-.673-1.5-1.5-1.5zM18 17H5a1 1 0 1 1 0-2h13v-2.5a.499.499 0 0 1 .829-.376l4 3.5a.516.516 0 0 1 0 .752l-4 3.5A.498.498 0 0 1 18 19.5V17z" />
      </svg>
      Sign In
    </button>
    <div class="g-signin2 fw-btn" data-onsuccess="onSignIn"></div>
  </form>
  <script>
    // document.getElementById("login-form").submit();
  </script>
</body>

</html>